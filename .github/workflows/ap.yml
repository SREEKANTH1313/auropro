name: Terraform-GitHub-Actions
on: workflow_dispatch
env:
 AWS_ACCESS_KEY_ID: AKIAR4HMVUUY364IJVWL
 AWS_SECRET_ACCESS_KEY: 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
 AWS_DEFAULT_REGION: us-west-2
 ECR_REPOSITORY: demo-project
 PRIVATE_SSH_KEY: ${{ secrets.AWS_SSH_KEY_PRIVATE }}
 PUBLIC_SSH_KEY: ${{ secrets.AWS_SSH_KEY_PUBLIC }}
 IMAGE_TAG: sample_image

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: Configuring AWS credentials

      
        uses: aws-actions/configure-aws-credentials@v1
        with:
         aws-region: us-east-1
      - name: Login to Amazon ECR
        id: login-ecr
        uses: aws-actions/amazon-ecr-login@v1
      - name: Deploy Docker Image to EC2
        uses: appleboy/ssh-action@master
        with:
         host: ${{ env.PUBLIC_SSH_KEY }}
         username: ec2-user
         key: ${{ env.PRIVATE_SSH_KEY }}
         run:
           touch saii
